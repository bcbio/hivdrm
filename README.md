# hivdrm
Detect HIV Drug Resitant Mutations using amplicon sequencing data

A production-ready re-implementation of https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7699007/,
https://github.com/Wei-Shao/HIV-DRLink.

## How to run

```bash
hivdrm.py --barcodes barcodes.csv --reference reference.edited.fasta r1.fq.gz r2.fq.gz
```

Example of barcodes.csv:
```
Sample_ID,Primers,F-Linkers,R-Linkers
S01,F1/R1,CGCCTG,GCCATG
S02,F1/R2,CGCCTG,TACAAG
S03,F1/R3,CGCCTG,ATTCCG
S04,F1/R4,CGCCTG,TCGGGA
S05,F1/R5,CGCCTG,GAATGA
S06,F1/R6,CGCCTG,GCCTAA
S07,F2/R1,CGTGAT,GCCATG
S08,F2/R2,CGTGAT,TACAAG
S09,F2/R3,CGTGAT,ATTCCG
S10,F2/R4,CGTGAT,TCGGGA
S11,F2/R5,CGTGAT,GAATGA
S12,F2/R6,CGTGAT,GCCTAA
S13,F3/R1,CTGATC,GCCATG
```

Example of reference.fasta:
```
>EF602219.1 HIV-1 isolate 1779 from South Africa pol protein (pol) gene, partial cds edited
CGCCTGAATCCATATAACACTCCAATATTTGCCATAAAAAAGAAGGACAGTACTAAGTGGAGAAAATTAGTAGATTTCAGGGAACTTAATAAAAGAACTCAAGACTTTTGGGAAGTTCAATTAGGAATACCACATCCAGCAGGATTAAAAAAGAAAAAATCAGTGACAGTACTGGATGTGGGGGATGCATATTTTTCAGTTCCTTTAGATGAAGGCTTCAGAAAATATACTGCATTCACCATACCTAGTATAAACAATGAAACACCAGGGATTAGATATCAATATAATGTGCTCCCAGGATCACCAGCAATATTCCAAAGTAGCATGACAAAAATCTTAGAGCCCTTTAGAGCAAGAAATCCAGAAATAGTCATCTATCAATATATGGATGACTTGTATGTGGGATCTGACTTAGAAATAGGGCAACATAGAGCAAAAATAGAGGAATTAAGAGCACATTTATTAGGGTGGGGATTTACCACWCCAGACAAGAAACATCAGAAGGAACCCCCATTTCTTTGGATGGGGTACGAACTCCATCCTGACAAATGGACAGTNNNNNNNNNNCTAGCAGGATGACTTCGATACCCATGGC
```

## Output

- DRM.xlsx - 1st sheet - DRM stats, then one sheet per sample
- freq.xlsx - barcode stats, per sample all and top allele frequencies
- `_hivdrm_tmp` - intermediate files from all the steps
